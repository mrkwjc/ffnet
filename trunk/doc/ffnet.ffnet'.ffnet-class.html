<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>ffnet.ffnet'.ffnet</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://ffnet.sourceforge.net">ffnet</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        Package&nbsp;ffnet ::
        <a href="ffnet.ffnet%27-module.html">Module&nbsp;ffnet'</a> ::
        Class&nbsp;ffnet
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="ffnet.ffnet%27.ffnet-class.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class ffnet</h1><p class="nomargin-top"><span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet">source&nbsp;code</a></span></p>
<pre class="literalblock">

Feed-forward neural network main class.

NETWORK CREATION:
Creation of the network consist in delivering list of neuron 
connections:
    conec = [[1, 3], [2, 3], [0, 3] 
             [1, 4], [2, 4], [0, 4] 
             [3, 5], [4, 5], [0, 5]]
    net = ffnet(conec)
0 (zero) in conec is a special unit representing bias. If there is
no connection from 0, bias is not considered in the node.
Only feed-forward directed graphs are allowed. Class makes check
for cycles in the provided graph and raises TypeError if any.
All nodes (exept input ones) have sigmoid activation function.

Although generation of conec is left to the user, there are several
functions provided to facilitate this task. See description of 
the following functions: mlgraph, imlgraph, tmlgraph.
More architectures may be provided in the future.

Weights are automatically initialized at the network creation. They can
be reinitialized later with 'randomweights' method.

TRAINING NETWORK:
There are several training methods included, currently:
train_momentum, train_rprop, train_genetic, train_cg, 
train_bfgs, train_tnc.
The simplest usage is, for example:
    net.train_tnc(input, target)
where 'input' and 'target' is data to be learned. Class performs data
normalization by itself and records encoding/decoding information 
to be used during network recalling.
Class makes basic checks of consistency of data.

For information about training prameters see appropriate 
method description.

RECALLING NETWORK:
Usage of the trained network is as simple as function call:
    ans = net(inp)
or, alternatively:
    ans = net.call(inp)
where 'inp' - list of network inputs and 'ans' - list of network outputs
There is also possibility to retrieve partial derivatives of 
output vs. input at given input point:
    deriv = n.derivative(inp)
'deriv' is an array of the form:
    | o1/i1, o1/i2, ..., o1/in |
    | o2/i1, o2/i2, ..., o2/in |
    | ...                      |
    | om/i1, om/i2, ..., om/in |

LOADING/SAVING/EXPORTING NETWORK
There are three helper functions provided with this class:
savenet, loadnet and exportnet.
Basic usage:
    savenet(net, filename)   --&gt; pickles network
    net = loadnet(filename)  --&gt; loads pickled network
    exportnet(net, filename) --&gt; exports network to fortran source

PLOTS
If you have matplotlib installed, the network architecture can be 
drawn with:
    from ffnet.tools import drawffnet
    import pylab
    drawffnet(net)
    pylab.show()
This is a very basic solution, see drawffnet description for
limitations.

</pre>

<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="__call__"></a><span class="summary-sig-name">__call__</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">inp</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.__call__">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="__init__"></a><span class="summary-sig-name">__init__</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">conec</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.__init__">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="__repr__"></a><span class="summary-sig-name">__repr__</span>(<span class="summary-sig-arg">self</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.__repr__">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_setnorm"></a><span class="summary-sig-name">_setnorm</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">input</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">target</span>=<span class="summary-sig-default">None</span>)</span><br />
      Retrieves normalization info from training data and normalizes data</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet._setnorm">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_testdata"></a><span class="summary-sig-name">_testdata</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">input</span>,
        <span class="summary-sig-arg">target</span>)</span><br />
      Tests input and target data</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet._testdata">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="call"></a><span class="summary-sig-name">call</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">inp</span>)</span><br />
      Returns network answer to input sequence (for one input sample or 2D 
      array of input samples)</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.call">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ffnet.ffnet%27.ffnet-class.html#derivative" class="summary-sig-name">derivative</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">inp</span>)</span><br />
      Returns partial derivatives of the network's 
output vs its input at given input point 
(for one input sample or 2D array of input samples)
in the following array:
    | o1/i1, o1/i2, ..., o1/in |
    | o2/i1, o2/i2, ..., o2/in |
    | ...</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.derivative">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="randomweights"></a><span class="summary-sig-name">randomweights</span>(<span class="summary-sig-arg">self</span>)</span><br />
      Randomize weights due to Bottou proposition</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.randomweights">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ffnet.ffnet%27.ffnet-class.html#sqerror" class="summary-sig-name">sqerror</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">input</span>,
        <span class="summary-sig-arg">target</span>)</span><br />
      Returns 0.5*(sum of squared errors at output) for input and target 
      arrays being first normalized.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.sqerror">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ffnet.ffnet%27.ffnet-class.html#sqgrad" class="summary-sig-name">sqgrad</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">input</span>,
        <span class="summary-sig-arg">target</span>)</span><br />
      Returns gradient of sqerror vs.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.sqgrad">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ffnet.ffnet%27.ffnet-class.html#test" class="summary-sig-name">test</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">input</span>,
        <span class="summary-sig-arg">target</span>,
        <span class="summary-sig-arg">iprint</span>=<span class="summary-sig-default">1</span>,
        <span class="summary-sig-arg">filename</span>=<span class="summary-sig-default">None</span>)</span><br />
      Calculates output and parameters of regression line of targets vs.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.test">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ffnet.ffnet%27.ffnet-class.html#train_bfgs" class="summary-sig-name">train_bfgs</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">input</span>,
        <span class="summary-sig-arg">target</span>,
        <span class="summary-sig-arg">**kwargs</span>)</span><br />
      Train network with constrained version of quasi-Newton method
of Broyden, Fletcher, Goldfarb, and Shanno (BFGS).</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.train_bfgs">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ffnet.ffnet%27.ffnet-class.html#train_cg" class="summary-sig-name">train_cg</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">input</span>,
        <span class="summary-sig-arg">target</span>,
        <span class="summary-sig-arg">**kwargs</span>)</span><br />
      Train network with conjugate gradient algorithm using the
nonlinear conjugate gradient algorithm of Polak and Ribiere.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.train_cg">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ffnet.ffnet%27.ffnet-class.html#train_genetic" class="summary-sig-name">train_genetic</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">input</span>,
        <span class="summary-sig-arg">target</span>,
        <span class="summary-sig-arg">**kwargs</span>)</span><br />
      Global weights optimization with genetic algorithm.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.train_genetic">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ffnet.ffnet%27.ffnet-class.html#train_momentum" class="summary-sig-name">train_momentum</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">input</span>,
        <span class="summary-sig-arg">target</span>,
        <span class="summary-sig-arg">eta</span>=<span class="summary-sig-default">0.2</span>,
        <span class="summary-sig-arg">momentum</span>=<span class="summary-sig-default">0.8</span>,
        <span class="summary-sig-arg">maxiter</span>=<span class="summary-sig-default">10000</span>,
        <span class="summary-sig-arg">disp</span>=<span class="summary-sig-default">0</span>)</span><br />
      Simple backpropagation training with momentum.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.train_momentum">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ffnet.ffnet%27.ffnet-class.html#train_rprop" class="summary-sig-name">train_rprop</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">input</span>,
        <span class="summary-sig-arg">target</span>,
        <span class="summary-sig-arg">a</span>=<span class="summary-sig-default">1.2</span>,
        <span class="summary-sig-arg">b</span>=<span class="summary-sig-default">0.5</span>,
        <span class="summary-sig-arg">mimin</span>=<span class="summary-sig-default">1e-06</span>,
        <span class="summary-sig-arg">mimax</span>=<span class="summary-sig-default">50.0</span>,
        <span class="summary-sig-arg">xmi</span>=<span class="summary-sig-default">0.1</span>,
        <span class="summary-sig-arg">maxiter</span>=<span class="summary-sig-default">10000</span>,
        <span class="summary-sig-arg">disp</span>=<span class="summary-sig-default">0</span>)</span><br />
      Rprop training algorithm.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.train_rprop">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ffnet.ffnet%27.ffnet-class.html#train_tnc" class="summary-sig-name">train_tnc</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">input</span>,
        <span class="summary-sig-arg">target</span>,
        <span class="summary-sig-arg">**kwargs</span>)</span><br />
      Train network with a TNC algorithm.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.train_tnc">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Method Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-MethodDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="derivative"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">derivative</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">inp</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.derivative">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Returns partial derivatives of the network's 
output vs its input at given input point 
(for one input sample or 2D array of input samples)
in the following array:
    | o1/i1, o1/i2, ..., o1/in |
    | o2/i1, o2/i2, ..., o2/in |
    | ...                      |
    | om/i1, om/i2, ..., om/in |

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="sqerror"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">sqerror</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">input</span>,
        <span class="sig-arg">target</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.sqerror">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns 0.5*(sum of squared errors at output) for input and target 
  arrays being first normalized. Might be slow in frequent use, because 
  data normalization is performed at ach call. (_setnorm should be called 
  before sqerror - will be changed in future)</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="sqgrad"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">sqgrad</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">input</span>,
        <span class="sig-arg">target</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.sqgrad">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns gradient of sqerror vs. network weights. Input and target 
  arrays are first normalized. Might be slow in frequent use, because data 
  normalization is performed at each call. (_setnorm should be called 
  before sqgrad - will be changed in future)</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="test"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">test</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">input</span>,
        <span class="sig-arg">target</span>,
        <span class="sig-arg">iprint</span>=<span class="sig-default">1</span>,
        <span class="sig-arg">filename</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.test">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Calculates output and parameters of regression line of targets vs. outputs.
Returns: (output, regress)
where regress contains regression line parameters for each output node. These
parameters are (slope, intercept, r, two-tailed prob, stderr-of-the-estimate).

Optional parameters:
iprint   - verbosity level:
           0 - print nothing
           1 - print regression parameters for each output node
           2 - print additionaly general network info and all targets vs. outputs
               (default is 1)
filename - string with path to the file; if given, output is redirected 
           to this file (default is None)

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="train_bfgs"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">train_bfgs</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">input</span>,
        <span class="sig-arg">target</span>,
        <span class="sig-arg">**kwargs</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.train_bfgs">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Train network with constrained version of quasi-Newton method
of Broyden, Fletcher, Goldfarb, and Shanno (BFGS). Algorithm is
called L_BFGS_B.

Allowed parameters:
bounds  -- a list of (min, max) pairs for each weight, defining
           the bounds on that parameter. Use None for one of min or max
           when there is no bound in that direction. At default all weights
           are bounded to (-100, 100)
m       -- the maximum number of variable metric corrections
           used to define the limited memory matrix. (the limited memory BFGS
           method does not store the full hessian but uses this many terms in an
           approximation to it). Default is 10.
factr   -- The iteration stops when
           (f^k - f^{k+1})/max{|f^k|,|f^{k+1}|,1} &lt;= factr*epsmch
           where f is current cost function value and
           epsmch is the machine precision, which is automatically
           generated by the code. Typical values for factr: 1e12 for
           low accuracy; 1e7 for moderate accuracy; 10.0 for extremely
           high accuracy. Default is 1e7.
pgtol   -- The iteration will stop when
           max{|proj g_i | i = 1, ..., n} &lt;= pgtol
           where pg_i is the ith component of the projected gradient.
           Default is 1e-5.
iprint  -- controls the frequency of output. &lt;0 means no output.
           Default is -1.
maxfun  -- maximum number of cost function evaluations. Default is 15000.

Note: optimization routine used here is part of scipy.optimize.
Note: there exist copyright notice for original optimization code:

License of L-BFGS-B (Fortran code)
==================================
The version included here (in fortran code) is 2.1 (released in 1997). It was
written by Ciyou Zhu, Richard Byrd, and Jorge Nocedal &lt;nocedal@ece.nwu.edu&gt;. It
carries the following condition for use:

This software is freely available, but we expect that all publications
describing  work using this software , or all commercial products using it,
quote at least one of the references given below.

References
* R. H. Byrd, P. Lu and J. Nocedal. A Limited Memory Algorithm for Bound
  Constrained Optimization, (1995), SIAM Journal on Scientific and
  Statistical Computing , 16, 5, pp. 1190-1208.
* C. Zhu, R. H. Byrd and J. Nocedal. L-BFGS-B: Algorithm 778: L-BFGS-B,
   FORTRAN routines for large scale bound constrained optimization (1997),
   ACM Transactions on Mathematical Software, Vol 23, Num. 4, pp. 550 - 560.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="train_cg"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">train_cg</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">input</span>,
        <span class="sig-arg">target</span>,
        <span class="sig-arg">**kwargs</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.train_cg">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Train network with conjugate gradient algorithm using the
nonlinear conjugate gradient algorithm of Polak and Ribiere.
See Wright, and Nocedal 'Numerical Optimization', 1999, pg. 120-122.

Allowed parameters:
gtol         - stop when norm of gradient is less than gtol
               (default is 1e-5)
norm         - order of vector norm to use (default is infinity)
maxiter      - the maximum number of iterations (default is 10000)
disp         - print convergence message at the end of training
               if non-zero (default is 1)

Note: this procedure does not produce any output during training.
Note: optimization routine used here is part of scipy.optimize.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="train_genetic"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">train_genetic</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">input</span>,
        <span class="sig-arg">target</span>,
        <span class="sig-arg">**kwargs</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.train_genetic">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Global weights optimization with genetic algorithm.

Allowed parameters:
lower        - lower bound of weights values (default is -25.)
upper        - upper bound of weights values (default is 25.)
individuals  - number of individuals in a population (default
               is 20)
generations  - number of generations over which solution is
               to evolve (default is 500)
crossover    - crossover probability; must be  &lt;= 1.0 (default
               is 0.85). If crossover takes place, either one
               or two splicing points are used, with equal
               probabilities
mutation     - 1/2/3/4/5 (default is 2)
               1=one-point mutation, fixed rate
               2=one-point, adjustable rate based on fitness
               3=one-point, adjustable rate based on distance
               4=one-point+creep, fixed rate
               5=one-point+creep, adjustable rate based on fitness
               6=one-point+creep, adjustable rate based on distance
initrate     - initial mutation rate; should be small (default
               is 0.005) (Note: the mutation rate is the proba-
               bility that any one gene locus will mutate in
               any one generation.)
minrate      - minimum mutation rate; must be &gt;= 0.0 (default
               is 0.0005)
maxrate      - maximum mutation rate; must be &lt;= 1.0 (default
               is 0.25)
fitnessdiff  - relative fitness differential; range from 0
               (none) to 1 (maximum).  (default is 1.)
reproduction - reproduction plan; 1/2/3=Full generational
               replacement/Steady-state-replace-random/Steady-
               state-replace-worst (default is 3)
elitism      - elitism flag; 0/1=off/on (default is 0)
               (Applies only to reproduction plans 1 and 2)
verbosity    - printed output 0/1/2=None/Minimal/Verbose
               (default is 0)

Note: this optimization routine is a python port of fortran pikaia code.

For more info see pikaia homepage and documentation:
http://www.hao.ucar.edu/Public/models/pikaia/pikaia.html

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="train_momentum"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">train_momentum</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">input</span>,
        <span class="sig-arg">target</span>,
        <span class="sig-arg">eta</span>=<span class="sig-default">0.2</span>,
        <span class="sig-arg">momentum</span>=<span class="sig-default">0.8</span>,
        <span class="sig-arg">maxiter</span>=<span class="sig-default">10000</span>,
        <span class="sig-arg">disp</span>=<span class="sig-default">0</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.train_momentum">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Simple backpropagation training with momentum.</p>
  <p>Allowed parameters: eta             - descent scaling parameter 
  (default is 0.2) momentum        - momentum coefficient (default is 0.8) 
  maxiter         - the maximum number of iterations (default is 10000) 
  disp            - print convergence message if non-zero (default is 
  0)</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="train_rprop"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">train_rprop</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">input</span>,
        <span class="sig-arg">target</span>,
        <span class="sig-arg">a</span>=<span class="sig-default">1.2</span>,
        <span class="sig-arg">b</span>=<span class="sig-default">0.5</span>,
        <span class="sig-arg">mimin</span>=<span class="sig-default">1e-06</span>,
        <span class="sig-arg">mimax</span>=<span class="sig-default">50.0</span>,
        <span class="sig-arg">xmi</span>=<span class="sig-default">0.1</span>,
        <span class="sig-arg">maxiter</span>=<span class="sig-default">10000</span>,
        <span class="sig-arg">disp</span>=<span class="sig-default">0</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.train_rprop">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Rprop training algorithm.

Allowed parameters:
a               - training step increasing parameter (default is 1.2)
b               - training step decreasing parameter (default is 0.5)
mimin           - minimum training step (default is 0.000001)
mimax           - maximum training step (default is 50.)
xmi             - vector containing initial training steps for weights;
                  if 'xmi' is a scalar then its value is set for all
                  weights (default is 0.1)
maxiter         - the maximum number of iterations (default is 10000)
disp            - print convergence message if non-zero (default is 0)

Method updates network weights and returns 'xmi' vector 
(after 'maxiter' iterations).

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="train_tnc"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">train_tnc</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">input</span>,
        <span class="sig-arg">target</span>,
        <span class="sig-arg">**kwargs</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ffnet.ffnet%27-pysrc.html#ffnet.train_tnc">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Train network with a TNC algorithm.
TNC is a C implementation of TNBC, a truncated newton
optimization package originally developed by Stephen G. Nash in Fortran.

Allowed parameters:
bounds    : a list of (min, max) pairs for each weight, defining
            the bounds on that parameter. Use None for one of min or max
            when there is no bound in that direction. At default all weights
            are bounded to (-100, 100)
scale      : scaling factors to apply to each weight (a list of floats)
            if None, the factors are up-low for interval bounded weights
            and 1+|weight| for the others.
            defaults to None
messages  : bit mask used to select messages display during minimization
            0: 'No messages',
            1: 'One line per iteration',
            2: 'Informational messages',
            4: 'Version info',
            8: 'Exit reasons',
            15: 'All messages'
            defaults to 0.
maxCGit   : max. number of hessian*vector evaluation per main iteration
            if maxCGit == 0, the direction chosen is -gradient
            if maxCGit &lt; 0, maxCGit is set to max(1,min(50,n/2))
            defaults to -1
maxfun    : max. number of function evaluation
            if None, maxnfeval is set to max(1000, 100*len(x0))
            defaults to None
eta       : severity of the line search. if &lt; 0 or &gt; 1, set to 0.25
            defaults to -1
stepmx    : maximum step for the line search. may be increased during call
            if too small, will be set to 10.0
            defaults to 0
accuracy  : relative precision for finite difference calculations
            if &lt;= machine_precision, set to sqrt(machine_precision)
            defaults to 0
fmin      : minimum cost function value estimate
            defaults to 0
ftol      : precision goal for the value of f in the stopping criterion
            relative to the machine precision and the value of f.
            if ftol &lt; 0.0, ftol is set to 0.0
            defaults to 0
rescale   : Scaling factor (in log10) used to trigger rescaling
            if 0, rescale at each iteration
            if a large value, never rescale
            if &lt; 0, rescale is set to 1.3.
            default to -1

Note: optimization routine used here is part of scipy.optimize.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://ffnet.sourceforge.net">ffnet</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sat Oct 24 22:26:50 2009
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
